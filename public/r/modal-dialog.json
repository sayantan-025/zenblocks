{
  "name": "modal-dialog",
  "type": "registry:block",
  "dependencies": [
    "framer-motion",
    "lucide-react",
    "react-dom"
  ],
  "registryDependencies": [],
  "files": [
    {
      "type": "registry:component",
      "path": "components/zenblocks/modal-dialog.tsx",
      "target": "components/zenblocks/modal-dialog.tsx",
      "content": "\"use client\";\r\n\r\nimport React, {\r\n    createContext,\r\n    useContext,\r\n    useEffect,\r\n    useRef,\r\n    useState,\r\n    useCallback,\r\n} from \"react\";\r\nimport { createPortal } from \"react-dom\";\r\nimport { AnimatePresence, motion, HTMLMotionProps } from \"framer-motion\";\r\nimport { X, Sparkles } from \"lucide-react\";\r\nimport { cn } from \"@/lib/utils\";\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                   TYPES                                    */\r\n/* -------------------------------------------------------------------------- */\r\n\r\ninterface ModalContextValue {\r\n    open: boolean;\r\n    setOpen: (open: boolean) => void;\r\n    titleId: string;\r\n    descriptionId: string;\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                  CONTEXT                                   */\r\n/* -------------------------------------------------------------------------- */\r\n\r\nconst ModalContext = createContext<ModalContextValue | undefined>(undefined);\r\n\r\nfunction useModal() {\r\n    const context = useContext(ModalContext);\r\n    if (!context) {\r\n        throw new Error(\"Modal compound components must be used within <ModalDialog>\");\r\n    }\r\n    return context;\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                ROOT COMPONENT                               */\r\n/* -------------------------------------------------------------------------- */\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*   Fix: Explicitly type children as ReactNode to avoid framer-motion clash   */\r\n/* -------------------------------------------------------------------------- */\r\n\r\ninterface ModalDialogProps {\r\n    children: React.ReactNode;\r\n    open?: boolean;\r\n    onOpenChange?: (open: boolean) => void;\r\n    defaultOpen?: boolean;\r\n}\r\n\r\nexport function ModalDialog({\r\n    children,\r\n    open: controlledOpen,\r\n    onOpenChange,\r\n    defaultOpen = false,\r\n}: ModalDialogProps) {\r\n    const [internalOpen, setInternalOpen] = useState(defaultOpen);\r\n    const isControlled = controlledOpen !== undefined;\r\n    const open = isControlled ? controlledOpen : internalOpen;\r\n\r\n    const setOpen = useCallback(\r\n        (newOpen: boolean) => {\r\n            if (!isControlled) {\r\n                setInternalOpen(newOpen);\r\n            }\r\n            onOpenChange?.(newOpen);\r\n        },\r\n        [isControlled, onOpenChange]\r\n    );\r\n\r\n    const titleId = React.useId();\r\n    const descriptionId = React.useId();\r\n\r\n    return (\r\n        <ModalContext.Provider value={{ open: !!open, setOpen, titleId, descriptionId }}>\r\n            {children}\r\n        </ModalContext.Provider>\r\n    );\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                   TRIGGER                                  */\r\n/* -------------------------------------------------------------------------- */\r\n\r\nexport function ModalTrigger({\r\n    children,\r\n    asChild = false,\r\n    className,\r\n    ...props\r\n}: React.ButtonHTMLAttributes<HTMLButtonElement> & { asChild?: boolean }) {\r\n    const { setOpen } = useModal();\r\n\r\n    if (asChild && React.isValidElement(children)) {\r\n        return React.cloneElement(children as React.ReactElement<any>, {\r\n            onClick: (e: React.MouseEvent) => {\r\n                (children as React.ReactElement<any>).props.onClick?.(e);\r\n                setOpen(true);\r\n            },\r\n            ...props,\r\n        });\r\n    }\r\n\r\n    return (\r\n        <button onClick={() => setOpen(true)} className={className} {...props}>\r\n            {children}\r\n        </button>\r\n    );\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                   PORTAL                                   */\r\n/* -------------------------------------------------------------------------- */\r\n\r\nfunction Portal({ children }: { children: React.ReactNode }) {\r\n    const [mounted, setMounted] = useState(false);\r\n    useEffect(() => setMounted(true), []);\r\n    if (!mounted || typeof document === \"undefined\") return null;\r\n    return createPortal(children, document.body);\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                   CONTENT                                  */\r\n/* -------------------------------------------------------------------------- */\r\n\r\ninterface ModalContentProps extends HTMLMotionProps<\"div\"> {\r\n    children: React.ReactNode;\r\n    overlayClassName?: string;\r\n    hideCloseButton?: boolean;\r\n    spotlightColor?: string;\r\n}\r\n\r\nexport function ModalContent({\r\n    children,\r\n    className,\r\n    overlayClassName,\r\n    hideCloseButton = false,\r\n    spotlightColor = \"rgba(255, 255, 255, 0.1)\",\r\n    ...props\r\n}: ModalContentProps) {\r\n    const { open, setOpen, titleId, descriptionId } = useModal();\r\n    const contentRef = useRef<HTMLDivElement>(null);\r\n    const [mousePosition, setMousePosition] = useState({ x: 0, y: 0 });\r\n\r\n    // Update spotlight on mouse move\r\n    const handleMouseMove = (e: React.MouseEvent<HTMLDivElement>) => {\r\n        const rect = contentRef.current?.getBoundingClientRect();\r\n        if (rect) {\r\n            setMousePosition({\r\n                x: e.clientX - rect.left,\r\n                y: e.clientY - rect.top,\r\n            });\r\n        }\r\n    };\r\n\r\n    // Focus Trap\r\n    useEffect(() => {\r\n        if (!open) return;\r\n        const focusableElements = 'button, [href], input, select, textarea, [tabindex]:not([tabindex=\"-1\"])';\r\n        const modal = contentRef.current;\r\n        if (!modal) return;\r\n\r\n        const firstElement = modal.querySelectorAll<HTMLElement>(focusableElements)[0];\r\n        const timer = setTimeout(() => firstElement?.focus(), 50);\r\n\r\n        const handleTab = (e: KeyboardEvent) => {\r\n            if (e.key === \"Tab\") {\r\n                const focusable = modal.querySelectorAll<HTMLElement>(focusableElements);\r\n                const first = focusable[0];\r\n                const last = focusable[focusable.length - 1];\r\n\r\n                if (e.shiftKey) {\r\n                    if (document.activeElement === first) {\r\n                        e.preventDefault();\r\n                        last?.focus();\r\n                    }\r\n                } else {\r\n                    if (document.activeElement === last) {\r\n                        e.preventDefault();\r\n                        first?.focus();\r\n                    }\r\n                }\r\n            }\r\n        };\r\n\r\n        modal.addEventListener(\"keydown\", handleTab);\r\n        return () => {\r\n            modal.removeEventListener(\"keydown\", handleTab);\r\n            clearTimeout(timer);\r\n        };\r\n    }, [open]);\r\n\r\n    // Scroll Lock\r\n    useEffect(() => {\r\n        if (open) {\r\n            document.body.style.overflow = \"hidden\";\r\n            document.body.style.paddingRight = \"var(--scrollbar-width, 0px)\";\r\n        } else {\r\n            document.body.style.overflow = \"\";\r\n            document.body.style.paddingRight = \"\";\r\n        }\r\n        return () => {\r\n            document.body.style.overflow = \"\";\r\n            document.body.style.paddingRight = \"\";\r\n        };\r\n    }, [open]);\r\n\r\n    // Escape Key\r\n    useEffect(() => {\r\n        const handleKeyDown = (e: KeyboardEvent) => {\r\n            if (e.key === \"Escape\" && open) {\r\n                setOpen(false);\r\n            }\r\n        };\r\n        document.addEventListener(\"keydown\", handleKeyDown);\r\n        return () => document.removeEventListener(\"keydown\", handleKeyDown);\r\n    }, [open, setOpen]);\r\n\r\n    return (\r\n        <Portal>\r\n            <AnimatePresence>\r\n                {open && (\r\n                    <>\r\n                        {/* Spotlight Backdrop */}\r\n                        <motion.div\r\n                            initial={{ opacity: 0 }}\r\n                            animate={{ opacity: 1 }}\r\n                            exit={{ opacity: 0 }}\r\n                            transition={{ duration: 0.3 }}\r\n                            className={cn(\r\n                                \"fixed inset-0 z-[100] bg-zinc-950/60 backdrop-blur-md\",\r\n                                overlayClassName\r\n                            )}\r\n                            onClick={() => setOpen(false)}\r\n                            aria-hidden=\"true\"\r\n                        >\r\n                            <div className=\"absolute inset-0 bg-[radial-gradient(circle_at_center,_var(--tw-gradient-stops))] from-indigo-500/10 via-transparent to-transparent opacity-50\" />\r\n                        </motion.div>\r\n\r\n                        {/* Dialog */}\r\n                        <div className=\"fixed inset-0 z-[101] flex items-center justify-center pointer-events-none p-4\">\r\n                            <motion.div\r\n                                ref={contentRef}\r\n                                role=\"dialog\"\r\n                                aria-modal=\"true\"\r\n                                aria-labelledby={titleId}\r\n                                aria-describedby={descriptionId}\r\n                                initial={{ opacity: 0, scale: 0.8, y: 20, rotateX: 10 }}\r\n                                animate={{ opacity: 1, scale: 1, y: 0, rotateX: 0 }}\r\n                                exit={{ opacity: 0, scale: 0.8, y: 20, transition: { duration: 0.2 } }}\r\n                                transition={{ type: \"spring\", stiffness: 300, damping: 25 }}\r\n                                className={cn(\r\n                                    \"pointer-events-auto relative w-full max-w-lg overflow-hidden rounded-3xl bg-zinc-900 border border-white/10 shadow-2xl isolate\",\r\n                                    className\r\n                                )}\r\n                                onMouseMove={handleMouseMove}\r\n                                {...props}\r\n                            >\r\n                                {/* Spotlight Cursor Effect */}\r\n                                <div\r\n                                    className=\"absolute -inset-px pointer-events-none opacity-50 transition-opacity duration-300\"\r\n                                    style={{\r\n                                        background: `radial-gradient(600px circle at ${mousePosition.x}px ${mousePosition.y}px, ${spotlightColor}, transparent 40%)`\r\n                                    }}\r\n                                />\r\n\r\n                                <div className=\"relative z-10 bg-zinc-950/90 h-full w-full\">\r\n                                    {children}\r\n                                </div>\r\n\r\n                                {!hideCloseButton && (\r\n                                    <button\r\n                                        onClick={() => setOpen(false)}\r\n                                        className=\"absolute right-4 top-4 z-50 rounded-full p-2 text-zinc-400 hover:text-white hover:bg-white/10 transition-colors\"\r\n                                    >\r\n                                        <X className=\"h-4 w-4\" />\r\n                                        <span className=\"sr-only\">Close</span>\r\n                                    </button>\r\n                                )}\r\n                            </motion.div>\r\n                        </div>\r\n                    </>\r\n                )}\r\n            </AnimatePresence>\r\n        </Portal>\r\n    );\r\n}\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                SUBCOMPONENTS                               */\r\n/* -------------------------------------------------------------------------- */\r\n\r\nexport function ModalHeader({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\r\n    return (\r\n        <div className={cn(\"flex flex-col space-y-1.5 p-6 pb-2 text-center sm:text-left\", className)} {...props} />\r\n    );\r\n}\r\n\r\nexport function ModalTitle({ className, ...props }: React.HTMLAttributes<HTMLHeadingElement>) {\r\n    const { titleId } = useModal();\r\n    return (\r\n        <h2 id={titleId} className={cn(\"text-xl font-bold tracking-tight text-white flex items-center gap-2\", className)} {...props}>\r\n            {props.children}\r\n        </h2>\r\n    );\r\n}\r\n\r\nexport function ModalDescription({ className, ...props }: React.HTMLAttributes<HTMLParagraphElement>) {\r\n    const { descriptionId } = useModal();\r\n    return (\r\n        <p id={descriptionId} className={cn(\"text-sm text-zinc-400 leading-relaxed\", className)} {...props} />\r\n    );\r\n}\r\n\r\nexport function ModalFooter({ className, ...props }: React.HTMLAttributes<HTMLDivElement>) {\r\n    return (\r\n        <div className={cn(\"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-3 px-6 pb-6 pt-4 bg-zinc-900/50 border-t border-white/5\", className)} {...props} />\r\n    );\r\n}\r\n\r\nexport function ModalClose({ children, asChild, className, ...props }: React.ButtonHTMLAttributes<HTMLButtonElement> & { asChild?: boolean }) {\r\n    const { setOpen } = useModal();\r\n\r\n    if (asChild && React.isValidElement(children)) {\r\n        return React.cloneElement(children as React.ReactElement<any>, {\r\n            onClick: (e: React.MouseEvent) => {\r\n                (children as React.ReactElement<any>).props.onClick?.(e);\r\n                setOpen(false);\r\n            },\r\n            ...props,\r\n        });\r\n    }\r\n\r\n    return (\r\n        <button onClick={() => setOpen(false)} className={className} {...props}>\r\n            {children}\r\n        </button>\r\n    );\r\n}\r\n\r\n// Namespace exports for easier imports\r\nModalDialog.Trigger = ModalTrigger;\r\nModalDialog.Content = ModalContent;\r\nModalDialog.Header = ModalHeader;\r\nModalDialog.Title = ModalTitle;\r\nModalDialog.Description = ModalDescription;\r\nModalDialog.Footer = ModalFooter;\r\nModalDialog.Close = ModalClose;\r\n\r\n/* -------------------------------------------------------------------------- */\r\n/*                                   DEMO                                     */\r\n/* -------------------------------------------------------------------------- */\r\n\r\nexport function ModalDialogDemo() {\r\n    return (\r\n        <div className=\"flex items-center justify-center p-12\">\r\n            <ModalDialog>\r\n                <ModalDialog.Trigger className=\"px-6 py-3 bg-gradient-to-r from-indigo-500 to-purple-600 text-white rounded-full text-sm font-bold shadow-lg shadow-indigo-500/25 hover:shadow-indigo-500/40 hover:scale-105 transition-all duration-300\">\r\n                    Open Spotlight Dialog\r\n                </ModalDialog.Trigger>\r\n                <ModalDialog.Content>\r\n                    <ModalDialog.Header>\r\n                        <ModalDialog.Title>\r\n                            <Sparkles className=\"w-5 h-5 text-indigo-400\" />\r\n                            Upgrade Plan\r\n                        </ModalDialog.Title>\r\n                        <ModalDialog.Description>\r\n                            Unlock premium features and take your productivity to the next level.\r\n                        </ModalDialog.Description>\r\n                    </ModalDialog.Header>\r\n\r\n                    <div className=\"p-6 space-y-4\">\r\n                        <div className=\"p-4 rounded-xl bg-white/5 border border-white/5 flex items-center justify-between group hover:border-indigo-500/50 transition-colors cursor-pointer\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-10 h-10 rounded-full bg-indigo-500/20 flex items-center justify-center text-indigo-400\">\r\n                                    üöÄ\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"font-medium text-white\">Pro Plan</div>\r\n                                    <div className=\"text-xs text-zinc-500\">$19/month</div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"w-4 h-4 rounded-full border border-zinc-600 group-hover:border-indigo-500 group-hover:bg-indigo-500 transition-colors\" />\r\n                        </div>\r\n                        <div className=\"p-4 rounded-xl bg-white/5 border border-white/5 flex items-center justify-between group hover:border-indigo-500/50 transition-colors cursor-pointer\">\r\n                            <div className=\"flex items-center gap-3\">\r\n                                <div className=\"w-10 h-10 rounded-full bg-purple-500/20 flex items-center justify-center text-purple-400\">\r\n                                    üè¢\r\n                                </div>\r\n                                <div>\r\n                                    <div className=\"font-medium text-white\">Team Plan</div>\r\n                                    <div className=\"text-xs text-zinc-500\">$49/month</div>\r\n                                </div>\r\n                            </div>\r\n                            <div className=\"w-4 h-4 rounded-full border border-zinc-600 group-hover:border-indigo-500 group-hover:bg-indigo-500 transition-colors\" />\r\n                        </div>\r\n                    </div>\r\n\r\n                    <ModalDialog.Footer>\r\n                        <ModalDialog.Close className=\"px-4 py-2 text-sm font-medium text-zinc-400 hover:text-white transition-colors\">\r\n                            Maybe Later\r\n                        </ModalDialog.Close>\r\n                        <button className=\"px-6 py-2 bg-white text-black rounded-lg text-sm font-bold hover:bg-zinc-200 transition-colors\" onClick={() => alert(\"Upgraded!\")}>\r\n                            Confirm Upgrade\r\n                        </button>\r\n                    </ModalDialog.Footer>\r\n                </ModalDialog.Content>\r\n            </ModalDialog>\r\n        </div>\r\n    );\r\n}\r\n"
    }
  ]
}